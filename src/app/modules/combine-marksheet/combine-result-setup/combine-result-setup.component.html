<section class="marksheet-list-section">
  <div class="page-inner">
    <div class="m-container">
      <div class="d-flex justify-content-between align-items-center flex-wrap my-3">
        <h3 class="sub_title mb-0">COMBINE MARKSHEET RESULT SETUP</h3>
        <button [routerLink]="CommonService.setUrl(URLConstants.COMBINE_MARKSHEET_LIST)" class="btn list-btn">
          Combine Marksheet List</button>
      </div>
    </div>
    <div class="card result-setup">
      <ng-container *ngIf="!isObjectEmpty(resultDetails) && !isResultSetup">
        <div class="row align-items-center">
          <div class="col-3">
            <div class="row" *ngIf="resultSettings">

              <!-- DROP DOWNS -->
              <!-- <div class="col-md-3 form_group d-flex align-items-center">
                <label for="" class="me-2">Grade Type : </label>
                <ng-select style="width: 100%;" *ngIf="isRerender" bindValue="id" bindLabel="name"
                  placeholder="Select Grade type" appendTo="body" [items]="gradeTypeList"
                  [(ngModel)]="resultSettings.section.grade_id" (ngModelChange)="gradeTypeChanged($event)"
                  [readonly]="resultSettings?.selected_column?.is_default_grade">
                </ng-select>
              </div>
              <div class="col-md-4 form_group">
                <label class="form_label">Select Subject Which Mark Not Include into Total Mark : </label> &nbsp;&nbsp;
                <ng-multiselect-dropdown class="w-100" placeholder="Select Subject"
                  [(ngModel)]="resultSettings.subject_not_added_in_total" [settings]="multiSelectDropdownSettings"
                  [data]="subjectList">
                </ng-multiselect-dropdown>
              </div> -->
    
              <!-- RANKING -->
              <div class="col-md-12 form_group student-form-group" *ngIf="resultSettings">
                <!-- <div > -->
                <label for="" class="form_label mb-2 me-4" style="white-space: nowrap;"> Ranking : </label>
                <div class="radio-section d-flex">
                  <div class="radio ">
                    <label class=" required mb-0 form_label">
                      <input type="radio" id="class_wise" [(ngModel)]="resultSettings.is_batch_wise" [value]="false"
                        class="mr-1">Class wise<span></span>
                    </label>
                  </div>
                  <div class="radio ">
                    <label class="required mb-0 form_label">
                      <input type="radio" id="batch_wise" [(ngModel)]="resultSettings.is_batch_wise" [value]="true"
                        class="mr-1">Batch wise<span></span>
                    </label>
                  </div>
                </div>
                <!-- <div class="student-dropdown student-radio-content d-flex align-items-center">
                    <div class="student-radio-btn me-3 d-flex" style="cursor: pointer;">
                      <input type="radio" id="class_wise" [(ngModel)]="resultSettings.is_batch_wise" [value]="false">
                      <label for="class_wise" class=" m-0 mx-1" style="cursor: pointer;">Class wise</label>
                    </div>
                    <div class="student-radio-btn d-flex" style="cursor: pointer;">
                      <input type="radio" id="batch_wise" [(ngModel)]="resultSettings.is_batch_wise" [value]="true">
                      <label for="batch_wise" class="m-0 mx-1" style="cursor: pointer;">Batch wise</label>
                    </div>
                  </div> -->
                <!-- </div> -->
    
                <!-- STUDENT WISE OR NOT ? -->
                <!-- <div class="d-flex align-items-center">
                  <div class="m-checkbox-list pt-1">
                    <label class="m-checkbox mb-0">
                      <input type="checkbox" [(ngModel)]="resultSettings.is_student_wise"
                        name="is_student_wise"><span></span>
                    </label>
                  </div>
                  <label for="checkbox" class="mb-0 ps-2">
                    <span>Student Wise Result</span>
                  </label>
                </div> -->
    
              </div>
            </div>
          </div>
          <div class="col-9">
            <div class="d-flex justify-content-between" *ngIf="resultSettings">
              <div class="row w-100">
                <div class="col-md-2 form_group">
                  <div class="d-flex align-items-center">
                    <div class="m-checkbox-list pt-1">
                      <label class="m-checkbox mb-0 form_label">
                        <input type="checkbox" [(ngModel)]="resultSettings.selected_column.is_default_grade"
                          (ngModelChange)="showDefaultGrade()" name="is_student_wise" id="default_checkbox" /><span></span>
                      </label>
                    </div>
                    <label for="default_checkbox" class="mb-0 ps-2 form_label">
                      <span>Default Grade</span>
                    </label>
                  </div>
                </div>
              
                <div class="col-md-auto form_group">
                  <div class="d-flex align-items-center">
                    <div class="m-checkbox-list pt-1">
                      <label class="m-checkbox mb-0 form_label">
                        <input type="checkbox" [(ngModel)]="resultSettings.semester_settings.grade"
                          name="is_semester_grade" id="is_semester_grade"/><span></span>
                      </label>
                    </div>
                    <label for="is_semester_grade" class="mb-0 ps-2 form_label">
                      <span>Semester Grade</span>
                    </label>
                  </div>
                </div>
    
                <div class="col-md-auto form_group">
                  <div class="d-flex align-items-center">
                    <div class="m-checkbox-list pt-1">
                      <label class="m-checkbox mb-0 form_label">
                        <input type="checkbox" [(ngModel)]="resultSettings.semester_settings.total_marks"
                          name="is_total_marks" id="is_semester_total_mark" /><span></span>
                      </label>
                    </div>
                    <label for="is_semester_total_mark" class="mb-0 ps-2 form_label">
                      <span>Semester Total Marks</span>
                    </label>
                  </div>
                </div>
    
                <div class="col-md-auto form_group">
                  <div class="d-flex align-items-center">
                    <div class="m-checkbox-list pt-1">
                      <label class="m-checkbox mb-0 form_label">
                        <input type="checkbox" [(ngModel)]="resultSettings.semester_settings.total_minimum_marks"
                          name="is_minimum_marks" id="is_minimum_marks"><span></span>
                      </label>
                    </div>
                    <label for="is_minimum_marks" class="mb-0 ps-2 form_label">
                      <span>Semester Minimum Marks</span>
                    </label>
                  </div>
                </div>
    
                <div class="col-md-auto form_group">
                  <div class="d-flex align-items-center">
                    <div class="m-checkbox-list pt-1">
                      <label class="m-checkbox mb-0 form_label">
                        <input type="checkbox" [(ngModel)]="resultSettings.is_role_no_wise"
                          name="is_role_no_wise" id="is_role_no_wise"><span></span>
                      </label>
                    </div>
                    <label for="is_role_no_wise" class="mb-0 ps-2 form_label">
                      <span>Roll Number Wise</span>
                    </label>
                  </div>
                </div>

                <div class="col-md-auto form_group">
                  <div class="d-flex align-items-center">
                    <div class="m-checkbox-list pt-1">
                      <label class="m-checkbox mb-0 form_label">
                        <input type="checkbox" [(ngModel)]="resultSettings.allow_inactive_student"
                          name="allow_inactive_student" id="allow_inactive_student"><span></span>
                      </label>
                    </div>
                    <label for="allow_inactive_student" class="mb-0 ps-2 form_label">
                      <span>Allow Inactive Student</span>
                    </label>
                  </div>
                </div>

                <div class="col-md-auto form_group">
                  <div class="d-flex align-items-center">
                    <div class="m-checkbox-list pt-1">
                      <label class="m-checkbox mb-0 form_label">
                        <input type="checkbox" [(ngModel)]="resultSettings.semester_settings.total_obtained"
                          name="is_semester_obtain_marks" id="is_semester_obtain_marks"><span></span>
                      </label>
                    </div>
                    <label for="is_semester_obtain_marks" class="mb-0 ps-2 form_label">
                      <span>Semester Obtain Marks</span>
                    </label>
                  </div>
                </div>
              </div>
    
            </div>
          </div>
        </div>
        
        <!-- TODO :----------------------------------------------------------------  BOTTOM CHECK BOX IS HERE -->

        

        <div class="exam-action-body subject-action-body">
          <!-- <div class="table-responsive"> -->

          <!-- TODO :---------------------------------------------------------------- MAIN TABLE TABLE -->

          <div class="exam-action-body subject-action-body">
            <div class="basic_table my-2">
              <div class="table-responsive">
                <ng-container *ngIf="mainData">
                  <table class="table table-hover table-nowrap table-bordered table datatable w-100 mb-0">

                    <thead>
                      <tr>
                        <th rowspan="2">Subject</th>
                        <ng-container *ngFor="let markSheet of mainData[0]?.mark_sheet">
                          <th class="marksheet_name text-center" [attr.colspan]="markSheet?.exams?.length + 2">
                            {{markSheet?.name || '-' }}
                          </th>
                        </ng-container>
                        <th rowspan="2">
                          <input type="checkbox" [(ngModel)]="resultSettings.selected_column.total_marks"
                            name="total_marks" id="total_in_header"><span></span>
                          <label for="total_in_header" >Total</label>
                        </th>
                        <th rowspan="2">
                          <input type="checkbox" [(ngModel)]="resultSettings.selected_column.grade"
                            name="grade" id="grade_in_header"><span></span>
                          <label for="grade_in_header">Grade</label>
                        </th>
                      </tr>

                      <tr>
                        <ng-container *ngFor="let markSheet of mainData[0]?.mark_sheet">
                          <ng-container *ngFor="let exam of markSheet?.exams">
                            <th>{{ exam?.name || '-' }}</th>
                          </ng-container>
                          <th>Total</th>
                          <th>Grade</th>
                        </ng-container>
                      </tr>
                    </thead>

                    <tbody>
                      <ng-container *ngFor="let subject of mainData">
                        <tr>
                          <td>{{ subject.name }}</td>
                          <ng-container *ngFor="let markSheet of subject?.mark_sheet">
                            <ng-container *ngFor="let exam of markSheet?.exams">
                              <td>
                                <input type="number" class="mark-input" placeholder="marks"
                                  [value]="exam?.converted_marks" readonly />
                              </td>
                            </ng-container>
                            <!-- Total for each MarkSheet -->
                            <td>
                              <input type="number" class="mark-input" placeholder="Total Marks"
                                [value]="subject.totalMarks" readonly />
                              <!-- <input type="number" class="mark-input" placeholder="Total Marks" 
                                      [value]="calculateTotal(markSheet)" readonly/> -->
                            </td>
                            <!-- Grade for each MarkSheet -->
                            <td>
                              <input type="text" class="mark-input" placeholder="Grade"
                                [value]="subject?.grade_type_name || '-' " readonly />
                              <!-- <input type="text" class="mark-input" placeholder="Grade" 
                                      [value]="getGrade(calculateTotal(markSheet))" readonly/> -->
                            </td>
                          </ng-container>
                          <!-- Grand Total -->
                          <td>
                            <input type="number" class="mark-input" placeholder="Grand Total"
                              [value]="calculateGrandTotal(subject?.mark_sheet)" readonly />
                            <!-- <input type="number" class="mark-input" placeholder="Grand Total" 
                                    [value]="calculateGrandTotal(subject?.mark_sheet)" readonly/> -->
                          </td>
                          <!-- Final Grade -->
                          <td>
                            <input type="text" class="mark-input" placeholder="Final Grade"
                              [value]="subject?.grade_type_name || '-' " readonly />
                            <!-- <input type="text" class="mark-input" placeholder="Final Grade" 
                                    [value]="getGrade(calculateGrandTotal(subject?.mark_sheet))" readonly/> -->
                          </td>
                        </tr>
                      </ng-container>

                      <!-- Result Settings Row -->
                      <tr *ngIf="resultSettings">
                        <td colspan="100%">
                          <div class="d-flex justify-content-between">
                            <span>
                              <div class="d-flex align-items-center">
                                <div class="m-checkbox-list pt-1">
                                  <label class="m-checkbox mb-0">
                                    <input type="checkbox" class="me-2"
                                      [(ngModel)]="resultSettings?.selected_column.over_all_marks" id="overall_marks_in_footer"> <span></span>
                                  </label>
                                </div>
                                <label for="overall_marks_in_footer" class="mb-0 ps-2 form_label">
                                  <span>OVERALL MARKS</span>
                                </label>
                              </div>
                            </span>
                            <span>
                              <div class="d-flex align-items-center">
                                <div class="m-checkbox-list pt-1">
                                  <label class="m-checkbox mb-0">
                                    <input type="checkbox" class="me-2"
                                      [(ngModel)]="resultSettings?.selected_column.percentage" id="percentage_in_footer"><span></span>
                                  </label>
                                </div>
                                <label for="percentage_in_footer" class="mb-0 ps-2 form_label">
                                  <span>PERCENTAGE</span>
                                </label>
                              </div>

                            </span>
                            <span>
                              <div class="d-flex align-items-center">
                                <div class="m-checkbox-list pt-1">
                                  <label class="m-checkbox mb-0">
                                    <input type="checkbox" class="me-2"
                                      [(ngModel)]="resultSettings?.selected_column.bottom_grade" id="grade_in_footer"><span></span>
                                  </label>
                                </div>
                                <label for="grade_in_footer" class="mb-0 ps-2 form_label">
                                  <span>GRADE</span>
                                </label>
                              </div>

                            </span>
                            <span>
                              <div class="d-flex align-items-center">
                                <div class="m-checkbox-list pt-1">
                                  <label class="m-checkbox mb-0">
                                    <input type="checkbox" class="me-2" [(ngModel)]="resultSettings.is_subject_code" id="subject_code_in_footer">
                                    <span></span>
                                  </label>
                                </div>
                                <label for="subject_code_in_footer" class="mb-0 ps-2 form_label">
                                  <span>SUBJECT CODE</span>
                                </label>
                              </div>
                            </span>
                            <span>
                              <div class="d-flex align-items-center">
                                <div class="m-checkbox-list pt-1">
                                  <label class="m-checkbox mb-0">
                                    <input type="checkbox" class="me-2"
                                      [(ngModel)]="resultSettings?.selected_column.result" id="result_in_footer"> <span></span>
                                  </label>
                                </div>
                                <label for="result_in_footer" class="mb-0 ps-2 form_label">
                                  <span>RESULT</span>
                                </label>
                              </div>
                            </span>
                            <span>
                              <div class="d-flex align-items-center">
                                <div class="m-checkbox-list pt-1">
                                  <label class="m-checkbox mb-0">
                                    <input type="checkbox" class="me-2"
                                      [(ngModel)]="resultSettings?.selected_column.water_mark" id="watermark_in_footer"><span></span>
                                  </label>
                                </div>
                                <label for="watermark_in_footer" class="mb-0 ps-2 form_label">
                                  <span>WATERMARK</span>
                                </label>
                              </div>
                            </span>
                            <span>
                              <div class="d-flex align-items-center">
                                <div class="m-checkbox-list pt-1">
                                  <label class="m-checkbox mb-0">
                                    <input type="checkbox" class="me-2"
                                      [(ngModel)]="resultSettings?.selected_column.minimum_marks" id="min_mark_in_footer"><span></span>
                                  </label>
                                </div>
                                <label for="min_mark_in_footer" class="mb-0 ps-2 form_label">
                                  <span>MINIMUM MARKS</span>
                                </label>
                              </div>
                            </span>
                          </div>
                        </td>
                      </tr>
                    </tbody>

                  </table>
                </ng-container>
              </div>
            </div>
          </div>

          <!-- TODO :---------------------------------------------------------------- CO-SCHOLASTIC TABLE -->

          <ng-container *ngIf="coScholasticData?.length > 0">
            <div class="exam-action-body subject-action-body">

              <!-- ? CO-SCHOLASTIC Grid view -->
              <div class="d-flex gap-3">
                <ng-container *ngIf="resultSettings?.co_scholastic?.gride_view">
                  <!-- First Table (Half of the Subjects) -->
                  <div class="basic_table my-2">
                    <div class="table-responsive">
                      <table class="table table-hover table-nowrap table-bordered table datatable w-100 mb-0">
                        <thead>
                          <tr>
                            <th rowspan="2">{{ resultSettings?.co_scholastic?.name || '-' }}
                              <a (click)="resultSettings.co_scholastic.gride_view = false"
                                style="float: right; color: #000;">
                                <i class="fa fa-list" aria-hidden="true"></i>
                              </a>
                            </th>
                            <th *ngFor="let markSheet of coScholasticData[0]?.mark_sheet">
                              {{ markSheet?.name || '-' }}
                            </th>
                          </tr>
                          <tr>
                            <th *ngFor="let markSheet of coScholasticData[0]?.mark_sheet">
                              Grade
                            </th>
                          </tr>
                        </thead>

                        <tbody>

                          <tr *ngFor="let subject of coScholasticData?.slice(0,coScholasticData?.length / 2)">
                            <td>{{ subject?.name || '-' }}</td>
                            <td *ngFor="let markSheet of subject?.mark_sheet">
                              <input type="text" class="mark-input mark-type-input"
                                [value]="markSheet?.exams[0]?.grade_id?.name" readonly />
                            </td>
                          </tr>

                        </tbody>
                      </table>
                    </div>
                  </div>

                  <!-- Second Table (Remaining Subjects) -->
                  <div class="basic_table my-2">
                    <div class="table-responsive">
                      <table class="table table-hover table-nowrap table-bordered table datatable w-100 mb-0">
                        <thead>
                          <tr>
                            <th rowspan="2">
                              {{ resultSettings?.co_scholastic?.name || '-' }}
                              <a (click)="resultSettings.co_scholastic.gride_view = false"
                                style="float: right; color: #000;">
                                <i class="fa fa-list" aria-hidden="true"></i>
                              </a>

                            </th>
                            <th *ngFor="let markSheet of coScholasticData[0]?.mark_sheet">
                              {{ markSheet?.name || '-' }}
                            </th>
                          </tr>
                          <tr>
                            <th *ngFor="let markSheet of coScholasticData[0]?.mark_sheet">
                              Grade
                            </th>
                          </tr>
                        </thead>

                        <tbody>

                          <tr *ngFor="let subject of coScholasticData?.slice(coScholasticData?.length / 2)">
                            <td>{{ subject?.name || '-' }}</td>
                            <td *ngFor="let markSheet of subject?.mark_sheet">
                              <input type="text" class="mark-input mark-type-input"
                                [value]="markSheet?.exams[0]?.grade_id?.name" readonly />
                            </td>
                          </tr>

                        </tbody>
                      </table>
                    </div>
                  </div>
                </ng-container>
              </div>

              <!-- ? CO-SCHOLASTIC List view-->
              <div class="basic_table my-2">
                <div class="table-responsive">
                  <table class="table table-hover table-nowrap table-bordered table datatable w-100 mb-0"
                    *ngIf="!resultSettings?.co_scholastic?.gride_view">

                    <thead>
                      <tr>
                        <th rowspan="2"> {{ resultSettings?.co_scholastic?.name || '-' }}
                          <a (click)="resultSettings.co_scholastic.gride_view = true"
                            style="float: right; color: #000;">
                            <i class="fa fa-th-large" aria-hidden="true"></i>
                          </a>
                        </th>
                        <th *ngFor="let markSheet of coScholasticData[0]?.mark_sheet">
                          {{ markSheet.name || '-' }}
                        </th>
                      </tr>
                      <tr>
                        <th *ngFor="let markSheet of coScholasticData[0]?.mark_sheet">
                          Grade
                        </th>
                      </tr>
                    </thead>

                    <tbody>

                      <tr *ngFor="let subject of coScholasticData">
                        <td>{{ subject.name || '-' }}</td>

                        <td *ngFor="let markSheet of subject?.mark_sheet">
                          <input type="text" class="mark-input mark-type-input"
                            [value]="markSheet.exams[0]?.grade_id?.name" readonly />
                        </td>
                      </tr>

                    </tbody>
                  </table>
                </div>
              </div>


            </div>
          </ng-container>

          <!-- TODO :---------------------------------------------------------------- SKILL HERE -->

          <ng-container *ngIf="skillData?.length > 0">
            <div class="exam-action-body subject-action-body">
              <div class="d-flex gap-3">

                <!-- ? SKILL SCHOLASTIC Grid view -->
                <ng-container *ngIf="resultSettings?.skill_subjects?.gride_view">

                  <!-- First Table (Half of the Subjects) -->
                  <div class="basic_table my-2">
                    <div class="table-responsive">
                      <table class="table table-hover table-nowrap table-bordered table datatable w-100 mb-0">
                        <thead>
                          <tr>

                            <th rowspan="2">Skill Subjects
                              <a (click)="resultSettings.skill_subjects.gride_view = false"
                                style="float: right; color: #000;">
                                <i class="fa fa-list" aria-hidden="true"></i>
                              </a>
                            </th>

                            <th colspan="2" *ngFor="let markSheet of skillData[0]?.mark_sheet">
                              {{markSheet?.name || '-' }}
                            </th>

                          </tr>
                          <tr>
                            <ng-container *ngFor="let markSheet of skillData[0]?.mark_sheet">
                              <td>Total Marks</td>
                              <td>Grade</td>
                            </ng-container>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let subject of skillData?.slice(0,skillData?.length / 2)">
                            <td>{{ subject?.name || '-' }}</td>

                            <ng-container *ngFor="let markSheet of subject?.mark_sheet">
                              <td>
                                <input type="text" class="mark-input mark-type-input"
                                  [value]="markSheet?.exams[0]?.total_marks" readonly />
                              </td>
                              <td>
                                <input type="text" class="mark-input mark-type-input"
                                  [value]="markSheet?.exams[0]?.exam_type_label" readonly />
                              </td>
                            </ng-container>
                          </tr>
                        </tbody>

                      </table>
                    </div>
                  </div>

                  <!-- Second Table (Remaining Subjects) -->
                  <div class="basic_table my-2">
                    <div class="table-responsive">
                      <table class="table table-hover table-nowrap table-bordered table datatable w-100 mb-0">
                        <thead>
                          <tr>

                            <th rowspan="2">Skill Subjects
                              <a (click)="resultSettings.skill_subjects.gride_view = false"
                                style="float: right; color: #000;">
                                <i class="fa fa-list" aria-hidden="true"></i>
                              </a>
                            </th>
                            <th colspan="2" *ngFor="let markSheet of skillData[0]?.mark_sheet">
                              {{markSheet?.name || '-' }}
                            </th>

                          </tr>
                          <tr>
                            <ng-container *ngFor="let markSheet of skillData[0]?.mark_sheet">
                              <td>Total Marks</td>
                              <td>Grade</td>
                            </ng-container>
                          </tr>
                        </thead>

                        <tbody>
                          <tr *ngFor="let subject of skillData?.slice(skillData?.length / 2)">
                            <td>{{ subject?.name || '-' }}</td>

                            <ng-container *ngFor="let markSheet of subject?.mark_sheet">
                              <td>
                                <input type="text" class="mark-input mark-type-input"
                                  [value]="markSheet?.exams[0]?.total_marks" readonly />
                              </td>
                              <td>
                                <input type="text" class="mark-input mark-type-input"
                                  [value]="markSheet?.exams[0]?.exam_type_label" readonly />
                              </td>
                            </ng-container>
                          </tr>
                        </tbody>

                      </table>
                    </div>
                  </div>

                </ng-container>

                <!-- ? SKILL SCHOLASTIC List View -->
                <ng-container *ngIf="!resultSettings?.skill_subjects?.gride_view">
                  <div class="basic_table my-2">
                    <div class="table-responsive">
                      <table class="table table-hover table-nowrap table-bordered table datatable w-100 mb-0">

                        <thead>
                          <tr>

                            <th rowspan="2">Skill Subjects
                              <a (click)="resultSettings.skill_subjects.gride_view = true"
                                style="float: right; color: #000;">
                                <i class="fa fa-th-large" aria-hidden="true"></i>
                              </a>
                            </th>
                            <th colspan="2" *ngFor="let markSheet of skillData[0]?.mark_sheet">
                              {{markSheet?.name || '-'}}
                            </th>

                          </tr>
                          <tr>
                            <ng-container *ngFor="let markSheet of skillData[0]?.mark_sheet">
                              <td>Total Marks</td>
                              <td>Grade</td>
                            </ng-container>
                          </tr>
                        </thead>

                        <tbody>
                          <tr *ngFor="let subject of skillData">
                            <td>{{ subject?.name || '-' }}</td>

                            <ng-container *ngFor="let markSheet of subject?.mark_sheet">
                              <td>
                                <input type="text" class="mark-input mark-type-input"
                                  [value]="markSheet?.exams[0]?.total_marks" readonly />
                              </td>
                              <td>
                                <input type="text" class="mark-input mark-type-input"
                                  [value]="markSheet?.exams[0]?.exam_type_label" readonly />
                              </td>
                            </ng-container>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>

                </ng-container>

              </div>
            </div>
          </ng-container>

          <!-- TODO :---------------------------------------------------------------- ATTENDANCE HERE -->

          <div class="exam-action-body subject-action-body my-2 d-flex" *ngIf="attendance">
            <div class="basic_table my-2">
              <div class="table-responsive">
                <!-- List View -->
                <table class="table table-hover table-nowrap table-bordered table datatable w-100 mb-0">
                  <thead>
                    <tr>
                      <th>
                        <div class="d-flex justify-content-between">
                          <input [(ngModel)]="attendance.name" type="text" class="form-control w-auto" style="padding: 4px 6px !important;">
                        </div>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2"
                                [(ngModel)]="attendance.column_name.total_working" id="total_working_in_attendance"><span></span>
                            </label>
                          </div>
                          <label for="total_working_in_attendance" class="mb-0 ps-2 form_label">
                            <span>Total Working</span>
                          </label>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2"
                                [(ngModel)]="attendance.column_name.present" id="present_in_attendance"><span></span>
                            </label>
                          </div>
                          <label for="present_in_attendance" class="mb-0 ps-2 form_label">
                            <span>Present</span>
                          </label>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2"
                                [(ngModel)]="attendance.column_name.absent" id="absent_in_attendance"><span></span>
                            </label>
                          </div>
                          <label for="absent_in_attendance" class="mb-0 ps-2 form_label">
                            <span>Absent</span>
                          </label>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2"
                                [(ngModel)]="attendance.column_name.leave" id="leave_in_attendance"><span></span>
                            </label>
                          </div>
                          <label for="leave_in_attendance" class="mb-0 ps-2 form_label">
                            <span>Leave</span>
                          </label>
                        </div>
                      </td>
                    </tr>

                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- TODO :---------------------------------------------------------------- REMARK HERE -->

          <div class="exam-action-body subject-action-body my-2">

            <!-- List View -->
            <div class="basic_table py-2 remarks_table">
              <div class="table-responsive">
                <table class="table table-hover table-nowrap table-bordered table datatable w-100 mb-0">
                  <thead>
                    <tr>
                      <th>
                        <div class="d-flex justify-content-between">
                          <input [(ngModel)]="remarks.name" type="text" class="form-control w-auto" style="padding: 4px 6px !important;">
                        </div>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2"
                                [(ngModel)]="remarks.column_name.teacher_remarks" id="teacher_remark_in_remark"><span></span>
                            </label>
                          </div>
                          <label for="teacher_remark_in_remark" class="mb-0  form_label" style="width:100%;">
                            <span>Teacher Remarks</span>
                          </label>

                          <ng-multiselect-dropdown class="w-25" placeholder="Select Remark"
                            [(ngModel)]="remarks?.column_name.teacher_remark_value"
                            [settings]="multiSelectDropdownSettings" [data]="classTeacherRemarkList">
                          </ng-multiselect-dropdown>

                        </div>
                      </td>
                    </tr>
                    <!-- <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2"
                                [(ngModel)]="remarks.column_name.school_will_be_re_open_on"><span></span>
                            </label>
                          </div>
                          <label for="checkbox" class="mb-0 ps-2 form_label">
                            <span>School Will Be Re-open On</span>
                          </label>
                          <app-mat-date-picker class="multiple-select-date"
                            [(selectedDate)]="remarks.column_name.school_will_be_re_open_on_value" [isRequired]="false"
                            [templateDriven]="true"></app-mat-date-picker>
                        </div>
                      </td>
                    </tr> -->
                    <!-- <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2"
                                [(ngModel)]="remarks?.column_name.promoted_class"><span></span>
                            </label>
                          </div>
                          <label for="checkbox" class="mb-0 ps-2 form_label">
                            <span>Promoted Class</span>
                          </label>
                          <input type="text" [(ngModel)]="remarks.column_name.promoted_class_value"
                            class="ms-4 width-25 form-control" placeholder="Please enter the Promoted Class">
                        </div>
                      </td>
                    </tr> -->
                    <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2" [(ngModel)]="remarks.column_name.place" id="place_in_remark"><span></span>
                            </label>
                          </div>
                          <label for="place_in_remark" class="mb-0 ps-2 form_label" style="width: 100%">
                            <span>Place</span>
                          </label>
                          <input type="text" [(ngModel)]="remarks.column_name.place_value"
                            class="width-25 form-control" placeholder="Please Enter the Place">
                        </div>
                      </td>
                    </tr>
                    <!-- <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2"
                                [(ngModel)]="remarks.column_name.result_date"><span></span>
                            </label>
                          </div>
                          <label for="checkbox" class="mb-0 ps-2 form_label">
                            <span>Result Date</span>
                          </label>
                          <app-mat-date-picker class="multiple-select-date ms-4"
                            [(selectedDate)]="remarks.column_name.result_date_value" [isRequired]="false"
                            [templateDriven]="true"></app-mat-date-picker>
                        </div>
                      </td>
                    </tr> -->
                    <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="m-checkbox-list pt-1">
                            <label class="m-checkbox mb-0">
                              <input type="checkbox" class="me-2" [(ngModel)]="remarks.column_name.note" id="note_in_remark"><span></span>
                            </label>
                          </div>
                          <label for="note_in_remark" class="mb-0 ps-2 form_label" style="width: 160%;">
                            <span>Note</span>
                          </label>
                          <input type="text" style="width: 75%;" class="form-control"
                            [(ngModel)]="remarks.column_name.note_value" placeholder="Please Enter the note">
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- TODO :---------------------------------------------------------------- SINGLE CHECKBOX HERE -->

          <div class="py-3 px-2">
            <span class="remarks_based_grade">
              <div class="d-flex align-items-center">
                <div class="m-checkbox-list pt-1">
                  <label class="m-checkbox mb-0">
                    <input type="checkbox" class="me-2"
                      [(ngModel)]="resultSettings?.remark?.column_name.remark_from_grade" id="display_remark_on_grade"><span></span>
                  </label>
                </div>
                <label for="display_remark_on_grade" class="mb-0 ps-2 form_label">
                  <span>Display Remarks Based on Grade Instead of Teacher Remarks.</span>
                </label>
              </div>
            </span>
          </div>

          <!-- TODO :---------------------------------------------------------------- SIGNATURE HERE -->

          <!-- <ng-container *ngIf="signatureDetails">

            <div class="signature-card" *ngIf="signatureDetails?.column_name">

              <div class="signature-label">
                <label class="form_label">Signatures</label>
              </div>

              <div class="row">
                <ng-container *ngFor="let signature of signatureDetails?.column_name">
                  <div class="col-lg-4 d-flex align-items-center justify-content-center w-100 ps-0">
                    <div class="col-auto ps-0">
                      <div class="d-flex align-items-center">
                        <div class="m-checkbox-list pt-1">
                          <label class="m-checkbox mb-0">
                            <input type="checkbox" class="form-control" [(ngModel)]="signature.signature"><span></span>
                          </label>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-5">
                      <input type="text" class="w-100 " [(ngModel)]="signature['signature-label']">
                    </div>
                    <div class="col-6">
                      <ng-select [(ngModel)]="signature['signature-user']" [items]="facultyList" bindLabel="name"
                        bindValue="id" placeholder="Select employee"></ng-select>
                    </div>
                  </div>
                </ng-container>
              </div>

            </div>

          </ng-container> -->

          <ng-container>
          
          <!-- TODO :---------------------------------------------------------------- CLASS DROPDOWN HERE -->
            
            <form [formGroup]="combineClassForm" class="pt-2">
              <div class="row">
                <div class="col-md-4 form-group">
                  <label class="form_label">Select Class </label>
                  <app-multi-select controlName="classF" placeholder="Select Class"
                    [dropDownArray]="classListDP" (change)="handleClassChange()"></app-multi-select>
                </div>
              </div>
          
              <!-- TODO :------------------FORM ARRAY HERE -->
          
          
              <div *ngFor="let classGroup of classWiseSettings.controls; let i = index" >
          
                <div class="mb-2 mt-3" style="font-weight: 600;">{{ getClassName(classGroup) }}</div>
                <div style="border: 1px solid #cbcaca; padding: 16px 10px;" class="row m-0">
                <!-- Grade Dropdown -->
                <div class="col-md-4 form-group">
                  <label class="form_label">Select Grade:</label>
                  <app-single-select [dropDownArray]="getGradeDropDown(classGroup)" [controlName]="'grade_id'"
                    formArrayName="class_wise_settings" [GroupName]="i" placeholder="Select Grade">
                  </app-single-select>
                  <!-- <app-single-select [dropDownArray]="gradeTypeList" [controlName]="'grade_id'"
                    formArrayName="class_wise_settings" [GroupName]="i" placeholder="Select Grade">
                  </app-single-select> -->
                </div>
                <!-- Subjects Multi-Select -->
                <div class="col-md-4 form-group">
                  <label class="form_label">Select Subject Which Mark Not Include into Total Mark : </label>
                  <app-multi-select [dropDownArray]="getClassDropDown(classGroup)" [controlName]="'subject_not_added_in_total'"
                    formArrayName="class_wise_settings" [GroupName]="i" [itemsShowLimit]="3" placeholder="Select Subjects">
                  </app-multi-select>
                </div>
                <div class="col-lg-4"></div>
                <!-- Result Date -->
                <div class="col-md-4 form-group d-inline-flex align-items-center">
                  <ng-container formArrayName="class_wise_settings">
                    <ng-container [formGroupName]="i">
                      <label class="m-checkbox mb-0 d-flex align-items-center" style="width:100%;">
                        <input type="checkbox" formControlName="result_date" [attr.id]="'result_date_class_wise_' + i" />
                      <span></span>
                      <label class="form_label mx-2 w-auto mb-0"  [attr.for]="'result_date_class_wise_' + i" >Result Date :</label>
                    </label>
                    </ng-container>
                  </ng-container>
                  <app-mat-date-picker class="multiple-select-date date-w-100 w-100" [GroupName]="i"
                    controlName="result_date_value" formArrayName="class_wise_settings">
                  </app-mat-date-picker>
                </div>
                <!-- Promoted Class -->
                <div class="col-md-4 form-group d-inline-flex align-items-center" formArrayName="class_wise_settings">
                  <ng-container [formGroupName]="i">
                    
                    <label class="m-checkbox mb-0 d-flex align-items-center" style="width:100%;">
                      <input type="checkbox" formControlName="promoted_class"  [attr.id]="'promoted_class_wise_' + i" />
                      <label class="form_label mx-2 w-auto mb-0" [attr.for]="'promoted_class_wise_' + i" >Promoted Class :</label>
                    <span></span>
                  </label>
                    <input class="date-w-100 w-100 form-control" style="padding: 6px !important;" type="text" formControlName="promoted_class_value"
                    placeholder="Enter the Promoted Class" />
                  </ng-container>
                </div>


                
                <!-- School Reopen Date -->
                <div class="col-md-4 form-group d-inline-flex align-items-center">
                  <ng-container formArrayName="class_wise_settings">
                    <ng-container [formGroupName]="i">
                      <label class="m-checkbox mb-0 d-flex align-items-center" style="width: 100%; overflow: unset; white-space: normal;">
                        <input type="checkbox" formControlName="school_will_be_re_open_on" [attr.id]="'school_reopen_class_wise_'+i" />
                      <span></span>
                      <label class="form_label mx-2 w-auto mb-0" style="white-space: normal;" [attr.for]="'school_reopen_class_wise_'+i"> School Will Reopen On :</label>
                      </label>
                    </ng-container>
                  </ng-container>
                  <app-mat-date-picker class="multiple-select-date date-w-100 w-100" [GroupName]="i"
                    controlName="school_will_be_re_open_on_value" formArrayName="class_wise_settings">
                  </app-mat-date-picker>
          
                </div>
          
                <!-- SIGNATURE PART  -->
                <ng-container [formGroup]="getClassFormGroup(i)">
                  <ng-container formArrayName="column_name">

                    <div style="padding: 16px; border-top: 1px solid #c6c6c6;">
                      <p class="m-0 form_label">Signature</p>
                    </div>
                    <ng-container *ngFor="let signatureControl of classGroup.get('column_name')?.['controls']; let j = index">
          
                      <div class="col-lg-4 d-flex align-items-center justify-content-center w-100 ps-0" [formGroupName]="j">
          
                        <div class="col-auto p-0">
                          <div class="d-flex align-items-center">
                            <div class="m-checkbox-list pt-1">
                              <label class="m-checkbox mb-0">
                                <input type="checkbox" formControlName="signature"><span></span>
                              </label>
                            </div>
                          </div>
                        </div>
          
                        <div class="col-md-5">
                          <input type="text" class="w-100 form-control" style="padding: 6px !important;" formControlName="signature-label">
                        </div>
          
                        <div class="col-6">
                          <ng-select formControlName="signature-user" [items]="facultyList" bindLabel="name" bindValue="id"
                            placeholder="Select employee">
                          </ng-select>
                        </div>
          
                      </div>
          
                    </ng-container>
                  </ng-container>
                </ng-container>
              </div>
            </div>
            </form>
          </ng-container>

        </div>

      </ng-container>

      <!-- TABLE DATA NOT FOUND -->
      <ng-container *ngIf="isObjectEmpty(resultDetails) && !isResultSetup">
        <div class="card p-3">
          <div class="d-flex justify-content-center">
            No Data Found.
          </div>
        </div>
      </ng-container>

      <!-- TABLE LOADING  -->
      <ng-container *ngIf="isResultSetup">
        <div class="card p-3">
          <div class="d-flex justify-content-center">
            <div class="spinner-border spinner-border-sm ms-2" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
        </div>
      </ng-container>

    </div>

    <div class="exam-action-footer text-end mb-3">
      <button class="btn save-btn mx-3" (click)="saveResultSetup()" [disabled]="is_loading">Save & Next
        <div class="spinner-border spinner-border-sm" role="status" *ngIf="is_loading">
          <span class="visually-hidden">Loading..."</span>
        </div>
      </button>
      <button class="btn clear-btn" (click)="fetchDetails()">Reset</button>
    </div>

  </div>
</section>